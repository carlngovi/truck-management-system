<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trip Management System with Time Tracking</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(45deg, #2c3e50, #3498db);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            font-weight: 300;
        }
        
        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }
        
        .main-content {
            padding: 30px;
        }
        
        .tab-navigation {
            display: flex;
            background: #f8f9fa;
            border-radius: 10px;
            padding: 5px;
            margin-bottom: 30px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
            flex-wrap: wrap;
            gap: 5px;
        }
        
        .tab-button {
            flex: 1;
            padding: 15px 20px;
            border: none;
            background: transparent;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            color: #7f8c8d;
            transition: all 0.3s ease;
            min-width: 140px;
        }
        
        .tab-button.active {
            background: linear-gradient(45deg, #3498db, #2980b9);
            color: white;
            box-shadow: 0 5px 15px rgba(52, 152, 219, 0.3);
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .date-selector {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .date-selector input, .date-selector select {
            padding: 10px 15px;
            border: 2px solid #e1e8ed;
            border-radius: 8px;
            font-size: 1em;
            background: white;
        }
        
        .navigation-buttons {
            display: flex;
            gap: 10px;
        }
        
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9em;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .btn-primary {
            background: linear-gradient(45deg, #3498db, #2980b9);
            color: white;
        }
        
        .btn-secondary {
            background: linear-gradient(45deg, #95a5a6, #7f8c8d);
            color: white;
        }
        
        .btn-success {
            background: linear-gradient(45deg, #27ae60, #2ecc71);
            color: white;
        }
        
        /* Dashboard Styles */
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin-bottom: 30px;
        }

        .dashboard-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            border-top: 5px solid #3498db;
        }

        .kpi-card { border-top-color: #27ae60; }
        .efficiency-card { border-top-color: #f39c12; }
        .forecast-card { border-top-color: #9b59b6; }

        .dashboard-card h3 {
            color: #2c3e50;
            margin-bottom: 20px;
            font-size: 1.5em;
        }

        .kpi-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 15px;
        }

        .kpi-item {
            text-align: center;
            padding: 15px;
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            border-radius: 8px;
            border-left: 4px solid #27ae60;
        }

        .kpi-value {
            font-size: 1.5em;
            font-weight: bold;
            color: #27ae60;
            margin-bottom: 5px;
        }

        .kpi-label {
            font-size: 0.8em;
            color: #7f8c8d;
            text-transform: uppercase;
        }
        
        /* Daily View Styles */
        .daily-view {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }
        
        .daily-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            border-top: 5px solid #3498db;
        }
        
        .daily-card h3 {
            color: #2c3e50;
            margin-bottom: 20px;
            font-size: 1.5em;
        }
        
        .trip-card { border-top-color: #e74c3c; }
        .fuel-card { border-top-color: #f39c12; }
        .distance-card { border-top-color: #9b59b6; }
        
        .input-group {
            margin-bottom: 20px;
        }
        
        .input-group label {
            display: block;
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 8px;
            font-size: 0.9em;
        }
        
        .input-group input, .input-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e1e8ed;
            border-radius: 8px;
            font-size: 1.1em;
            transition: border-color 0.3s ease;
        }

        .input-group input:focus, .input-group select:focus {
            outline: none;
            border-color: #3498db;
        }

        .input-hint {
            font-size: 0.8em;
            color: #7f8c8d;
            margin-top: 5px;
        }
        
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .metric-item {
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            border-left: 4px solid #3498db;
        }
        
        .metric-label {
            font-size: 0.75em;
            color: #7f8c8d;
            margin-bottom: 5px;
            text-transform: uppercase;
        }
        
        .metric-value {
            font-size: 1.1em;
            font-weight: bold;
            color: #2c3e50;
        }
        
        .month-navigation {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding: 15px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
        }
        
        .current-date {
            font-size: 1.2em;
            font-weight: 600;
            color: #2c3e50;
        }

        /* Monthly Calendar Styles */
        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 2px;
            background: #ecf0f1;
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        
        .day-header {
            background: linear-gradient(45deg, #34495e, #2c3e50);
            color: white;
            text-align: center;
            padding: 15px 5px;
            font-weight: 600;
            font-size: 0.9em;
        }
        
        .day-cell {
            background: white;
            min-height: 80px;
            position: relative;
            display: flex;
            flex-direction: column;
            padding: 8px;
            transition: all 0.3s ease;
            border: 2px solid transparent;
            cursor: pointer;
        }
        
        .day-cell:hover {
            background: #f8f9fa;
            border-color: #3498db;
        }
        
        .day-cell.other-month {
            background: #f7f9fc;
            color: #bdc3c7;
        }
        
        .day-cell.weekend {
            background: linear-gradient(135deg, #ffeaa7, #fab1a0);
        }
        
        .day-cell.today {
            background: linear-gradient(135deg, #74b9ff, #0984e3);
            color: white;
        }
        
        .day-cell.has-data {
            background: linear-gradient(135deg, #e8f5e8, #d4edda);
            border-color: #27ae60;
        }
        
        .day-number {
            font-weight: 600;
            font-size: 0.9em;
            color: #2c3e50;
            margin-bottom: 5px;
        }
        
        .trip-input {
            width: 100%;
            padding: 6px;
            border: 1px solid #ddd;
            border-radius: 4px;
            text-align: center;
            font-size: 0.9em;
            margin-bottom: 5px;
        }
        
        .day-total {
            font-size: 0.7em;
            color: #27ae60;
            font-weight: 600;
            text-align: center;
        }
        
        .monthly-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
            text-align: center;
            border-top: 4px solid #3498db;
        }
        
        .stat-card h4 {
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 0.9em;
            text-transform: uppercase;
        }
        
        .stat-card .value {
            font-size: 1.8em;
            font-weight: bold;
            color: #3498db;
        }

        /* Cost Centre Styles */
        .cost-centres-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .cost-centre-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            position: relative;
            overflow: hidden;
        }
        
        .cost-centre-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(90deg, #3498db, #2980b9);
        }
        
        .centre-header {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .centre-icon {
            font-size: 2em;
            margin-right: 15px;
            padding: 10px;
            border-radius: 50%;
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
        }
        
        .centre-info h3 {
            margin: 0;
            color: #2c3e50;
            font-size: 1.3em;
            font-weight: 600;
        }
        
        .rate-info {
            color: #7f8c8d;
            font-size: 0.9em;
            font-weight: 500;
        }
        
        .centre-amount {
            font-size: 2em;
            font-weight: bold;
            color: #27ae60;
            text-align: center;
            margin: 15px 0;
            padding: 15px;
            background: linear-gradient(135deg, #e8f5e8, #d5f5d5);
            border-radius: 10px;
        }

        /* Notifications */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 25px;
            border-radius: 8px;
            font-weight: 600;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            z-index: 1001;
            animation: slideInRight 0.3s ease-out;
            max-width: 300px;
        }

        .notification.success {
            background: linear-gradient(45deg, #27ae60, #2ecc71);
            color: white;
        }

        @keyframes slideInRight {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        @keyframes slideOutRight {
            from { transform: translateX(0); opacity: 1; }
            to { transform: translateX(100%); opacity: 0; }
        }
        
        @media (max-width: 768px) {
            .daily-view {
                grid-template-columns: 1fr;
            }
            
            .dashboard-grid {
                grid-template-columns: 1fr;
            }

            .tab-navigation {
                flex-direction: column;
            }

            .tab-button {
                min-width: auto;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🚛 Trip Management System</h1>
            <p>Complete tracking with time analytics and comprehensive insights (Kenya Shillings)</p>
        </div>
        
        <div class="main-content">
            <div class="tab-navigation">
                <button class="tab-button active" onclick="switchTab('dashboard')">
                    📊 Dashboard
                </button>
                <button class="tab-button" onclick="switchTab('daily')">
                    📝 Daily Entry
                </button>
                <button class="tab-button" onclick="switchTab('monthly')">
                    📅 Monthly View
                </button>
                <button class="tab-button" onclick="switchTab('totals')">
                    💰 Cost Centres
                </button>
            </div>
            
            <!-- Dashboard Tab -->
            <div id="dashboard-tab" class="tab-content active">
                <div class="dashboard-grid">
                    <div class="dashboard-card kpi-card">
                        <h3>📊 Key Performance Indicators</h3>
                        <div class="kpi-grid">
                            <div class="kpi-item">
                                <div class="kpi-value" id="dashboardTotalTrips">131</div>
                                <div class="kpi-label">Total Trips</div>
                            </div>
                            <div class="kpi-item">
                                <div class="kpi-value" id="dashboardRevenue">KES 458,500</div>
                                <div class="kpi-label">Revenue</div>
                            </div>
                            <div class="kpi-item">
                                <div class="kpi-value" id="dashboardProfit">KES 62,225</div>
                                <div class="kpi-label">Profit</div>
                            </div>
                            <div class="kpi-item">
                                <div class="kpi-value" id="dashboardMargin">13.6%</div>
                                <div class="kpi-label">Profit Margin</div>
                            </div>
                        </div>
                    </div>

                    <div class="dashboard-card efficiency-card">
                        <h3>⚡ Efficiency Metrics</h3>
                        <div class="kpi-grid">
                            <div class="kpi-item">
                                <div class="kpi-value" id="avgTripsPerDay">8.2</div>
                                <div class="kpi-label">Avg Trips/Day</div>
                            </div>
                            <div class="kpi-item">
                                <div class="kpi-value" id="fuelEfficiency">8.1</div>
                                <div class="kpi-label">Km/Litre</div>
                            </div>
                            <div class="kpi-item">
                                <div class="kpi-value" id="workingDays">16</div>
                                <div class="kpi-label">Working Days</div>
                            </div>
                            <div class="kpi-item">
                                <div class="kpi-value" id="utilizationRate">80%</div>
                                <div class="kpi-label">Utilization</div>
                            </div>
                            <div class="kpi-item">
                                <div class="kpi-value" id="avgHoursPerDay">19.8h</div>
                                <div class="kpi-label">Avg Hours/Day</div>
                            </div>
                            <div class="kpi-item">
                                <div class="kpi-value" id="avgRevenuePerHour">KES 1,450</div>
                                <div class="kpi-label">Revenue/Hour</div>
                            </div>
                        </div>
                    </div>

                    <div class="dashboard-card forecast-card">
                        <h3>🔮 Monthly Forecast</h3>
                        <div class="kpi-grid">
                            <div class="kpi-item">
                                <div class="kpi-value" id="projectedTrips">170</div>
                                <div class="kpi-label">Projected Trips</div>
                            </div>
                            <div class="kpi-item">
                                <div class="kpi-value" id="projectedRevenue">KES 595,000</div>
                                <div class="kpi-label">Proj. Revenue</div>
                            </div>
                            <div class="kpi-item">
                                <div class="kpi-value" id="targetVariance">-15%</div>
                                <div class="kpi-label">Target Variance</div>
                            </div>
                            <div class="kpi-item">
                                <div class="kpi-value" id="daysRemaining">2</div>
                                <div class="kpi-label">Days Left</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Daily Management Tab -->
            <div id="daily-tab" class="tab-content">
                <div class="controls">
                    <div class="date-selector">
                        <label for="currentDate">Date:</label>
                        <input type="date" id="currentDate" value="2025-06-28" onchange="updateDaily()">
                    </div>
                    
                    <div class="navigation-buttons">
                        <button class="btn btn-secondary" onclick="previousDay()">⬅ Previous</button>
                        <button class="btn btn-primary" onclick="goToToday()">Today</button>
                        <button class="btn btn-secondary" onclick="nextDay()">Next ➡</button>
                        <button class="btn btn-success" onclick="quickSave()">💾 Quick Save</button>
                    </div>
                </div>
                
                <div class="month-navigation">
                    <div class="current-date" id="displayDate">Friday, June 28, 2025</div>
                    <div class="day-info">
                        <span id="dayType">Working Day</span> | 
                        <span id="monthProgress">Day 28 of 30</span>
                    </div>
                </div>
                
                <div class="daily-view">
                    <div class="daily-card trip-card">
                        <h3>🚛 Trip Information</h3>
                        
                        <div class="input-group">
                            <label for="dailyTrips">Number of Trips</label>
                            <input type="number" id="dailyTrips" min="0" placeholder="Enter trips" onchange="calculateDaily()">
                        </div>

                        <div class="input-group">
                            <label for="routeSelect">Primary Route</label>
                            <select id="routeSelect" onchange="calculateDaily()">
                                <option value="">Select route...</option>
                                <option value="nairobi-mombasa">Nairobi - Mombasa</option>
                                <option value="nairobi-kisumu">Nairobi - Kisumu</option>
                                <option value="nairobi-nakuru">Nairobi - Nakuru</option>
                                <option value="local-delivery">Local Delivery</option>
                                <option value="other">Other</option>
                            </select>
                        </div>

                        <div class="input-group">
                            <label for="avgTripTime">Average Time per Trip (hours)</label>
                            <input type="number" id="avgTripTime" min="0" step="0.5" placeholder="e.g., 2.5" onchange="calculateDaily()">
                            <div class="input-hint">Include loading, travel, and unloading time</div>
                        </div>
                        
                        <div class="metrics-grid">
                            <div class="metric-item">
                                <div class="metric-label">Daily Revenue</div>
                                <div class="metric-value" id="dailyRevenue">KES 0</div>
                            </div>
                            <div class="metric-item">
                                <div class="metric-label">Total Hours</div>
                                <div class="metric-value" id="totalHours">0.0h</div>
                            </div>
                            <div class="metric-item">
                                <div class="metric-label">Revenue/Hour</div>
                                <div class="metric-value" id="revenuePerHour">KES 0</div>
                            </div>
                            <div class="metric-item">
                                <div class="metric-label">Trip Rate</div>
                                <div class="metric-value">KES 3,500</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="daily-card fuel-card">
                        <h3>⛽ Fuel Management</h3>
                        
                        <div class="input-group">
                            <label for="actualFuelSpent">Fuel Cost (KES)</label>
                            <input type="number" id="actualFuelSpent" placeholder="Enter fuel cost" onchange="calculateDaily()">
                        </div>
                        
                        <div class="input-group">
                            <label for="fuelLitres">Litres Purchased</label>
                            <input type="number" id="fuelLitres" step="0.1" placeholder="Enter litres" onchange="calculateDaily()">
                        </div>

                        <div class="input-group">
                            <label for="fuelStation">Fuel Station</label>
                            <select id="fuelStation">
                                <option value="">Select station...</option>
                                <option value="shell">Shell</option>
                                <option value="total">Total</option>
                                <option value="kenol">Kenol</option>
                                <option value="other">Other</option>
                            </select>
                        </div>
                        
                        <div class="metrics-grid">
                            <div class="metric-item">
                                <div class="metric-label">Price/Litre</div>
                                <div class="metric-value" id="pricePerLitre">KES 0</div>
                            </div>
                            <div class="metric-item">
                                <div class="metric-label">Fuel Variance</div>
                                <div class="metric-value" id="fuelVariance">KES 0</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="daily-card distance-card">
                        <h3>📏 Distance & Performance</h3>
                        
                        <div class="input-group">
                            <label for="totalKilometers">Total Kilometers</label>
                            <input type="number" id="totalKilometers" step="0.1" placeholder="Enter km" onchange="calculateDaily()">
                        </div>

                        <div class="input-group">
                            <label for="vehicleCondition">Vehicle Condition</label>
                            <select id="vehicleCondition">
                                <option value="excellent">Excellent</option>
                                <option value="good" selected>Good</option>
                                <option value="fair">Fair</option>
                                <option value="needs-attention">Needs Attention</option>
                            </select>
                        </div>
                        
                        <div class="metrics-grid">
                            <div class="metric-item">
                                <div class="metric-label">Km/Trip</div>
                                <div class="metric-value" id="kmPerTrip">0</div>
                            </div>
                            <div class="metric-item">
                                <div class="metric-label">Km/Litre</div>
                                <div class="metric-value" id="kmPerLitre">0</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Monthly Summary Tab -->
            <div id="monthly-tab" class="tab-content">
                <div class="controls">
                    <div class="date-selector">
                        <label for="monthSelect">Month:</label>
                        <select id="monthSelect" onchange="updateMonthlyCalendar()">
                            <option value="0">January</option>
                            <option value="1">February</option>
                            <option value="2">March</option>
                            <option value="3">April</option>
                            <option value="4">May</option>
                            <option value="5" selected>June</option>
                            <option value="6">July</option>
                            <option value="7">August</option>
                            <option value="8">September</option>
                            <option value="9">October</option>
                            <option value="10">November</option>
                            <option value="11">December</option>
                        </select>
                        <select id="yearSelect" onchange="updateMonthlyCalendar()">
                            <option value="2023">2023</option>
                            <option value="2024">2024</option>
                            <option value="2025" selected>2025</option>
                            <option value="2026">2026</option>
                        </select>
                    </div>
                    
                    <div class="navigation-buttons">
                        <button class="btn btn-secondary" onclick="fillWeekdays(7)">Fill Weekdays (7)</button>
                        <button class="btn btn-success" onclick="fillWeekdays(10)">Fill Weekdays (10)</button>
                    </div>
                </div>
                
                <div class="calendar-grid" id="monthlyCalendarGrid">
                    <!-- Calendar will be generated here -->
                </div>
                
                <div class="monthly-stats">
                    <div class="stat-card">
                        <h4>Total Trips</h4>
                        <div class="value" id="monthlyTotalTrips">131</div>
                    </div>
                    <div class="stat-card">
                        <h4>Working Days</h4>
                        <div class="value" id="monthlyWorkingDays">16</div>
                    </div>
                    <div class="stat-card">
                        <h4>Monthly Revenue</h4>
                        <div class="value" id="monthlyRevenue">KES 458,500</div>
                    </div>
                    <div class="stat-card">
                        <h4>Average per Day</h4>
                        <div class="value" id="monthlyAvgPerDay">KES 28,656</div>
                    </div>
                    <div class="stat-card">
                        <h4>Best Day</h4>
                        <div class="value" id="monthlyBestDay">11 trips (Day 10)</div>
                    </div>
                    <div class="stat-card">
                        <h4>Total Hours</h4>
                        <div class="value" id="monthlyTotalHours">316.8h</div>
                    </div>
                </div>
            </div>
            
            <!-- Cost Centre Totals Tab -->
            <div id="totals-tab" class="tab-content">
                <div class="controls">
                    <div class="date-selector">
                        <label for="totalsMonth">Period:</label>
                        <select id="totalsMonth" onchange="updateTotalsView()">
                            <option value="0">January</option>
                            <option value="1">February</option>
                            <option value="2">March</option>
                            <option value="3">April</option>
                            <option value="4">May</option>
                            <option value="5" selected>June</option>
                            <option value="6">July</option>
                            <option value="7">August</option>
                            <option value="8">September</option>
                            <option value="9">October</option>
                            <option value="10">November</option>
                            <option value="11">December</option>
                        </select>
                        <select id="totalsYear" onchange="updateTotalsView()">
                            <option value="2023">2023</option>
                            <option value="2024">2024</option>
                            <option value="2025" selected>2025</option>
                            <option value="2026">2026</option>
                        </select>
                    </div>
                    
                    <div style="display: flex; gap: 30px; font-weight: 600; color: #2c3e50;">
                        <span>Total Trips: <strong id="totalTripsCount">131</strong></span>
                        <span>Total Revenue: <strong id="totalRevenueAmount">KES 458,500</strong></span>
                    </div>
                </div>
                
                <div class="cost-centres-grid">
                    <div class="cost-centre-card">
                        <div class="centre-header">
                            <div class="centre-icon">⛽</div>
                            <div class="centre-info">
                                <h3>Fuel Cost</h3>
                                <span class="rate-info">KES 1,300 per trip</span>
                            </div>
                        </div>
                        <div class="centre-amount" id="fuelCostTotal">KES 170,300</div>
                    </div>
                    
                    <div class="cost-centre-card">
                        <div class="centre-header">
                            <div class="centre-icon">📈</div>
                            <div class="centre-info">
                                <h3>Fuel Interest</h3>
                                <span class="rate-info">KES 195 per trip (15%)</span>
                            </div>
                        </div>
                        <div class="centre-amount" id="fuelInterestTotal">KES 25,545</div>
                    </div>
                    
                    <div class="cost-centre-card">
                        <div class="centre-header">
                            <div class="centre-icon">🚗</div>
                            <div class="centre-info">
                                <h3>Driver</h3>
                                <span class="rate-info">KES 250 per trip</span>
                            </div>
                        </div>
                        <div class="centre-amount" id="driverTotal">KES 32,750</div>
                    </div>
                    
                    <div class="cost-centre-card">
                        <div class="centre-header">
                            <div class="centre-icon">👨‍💼</div>
                            <div class="centre-info">
                                <h3>Mike</h3>
                                <span class="rate-info">KES 200 per trip</span>
                            </div>
                        </div>
                        <div class="centre-amount" id="mikeTotalAmount">KES 26,200</div>
                    </div>
                    
                    <div class="cost-centre-card">
                        <div class="centre-header">
                            <div class="centre-icon">⚓</div>
                            <div class="centre-info">
                                <h3>Captain</h3>
                                <span class="rate-info">KES 100 per trip</span>
                            </div>
                        </div>
                        <div class="centre-amount" id="captainTotalAmount">KES 13,100</div>
                    </div>
                    
                    <div class="cost-centre-card">
                        <div class="centre-header">
                            <div class="centre-icon">👔</div>
                            <div class="centre-info">
                                <h3>Boss</h3>
                                <span class="rate-info">KES 100 per trip</span>
                            </div>
                        </div>
                        <div class="centre-amount" id="bossTotalAmount">KES 13,100</div>
                    </div>
                    
                    <div class="cost-centre-card">
                        <div class="centre-header">
                            <div class="centre-icon">🚛</div>
                            <div class="centre-info">
                                <h3>Truck</h3>
                                <span class="rate-info">KES 478 per trip</span>
                            </div>
                        </div>
                        <div class="centre-amount" id="truckTotal">KES 62,618</div>
                    </div>
                    
                    <div class="cost-centre-card">
                        <div class="centre-header">
                            <div class="centre-icon">🏗️</div>
                            <div class="centre-info">
                                <h3>Capex</h3>
                                <span class="rate-info">KES 502 per trip</span>
                            </div>
                        </div>
                        <div class="centre-amount" id="capexTotal">KES 65,762</div>
                    </div>
                    
                    <div class="cost-centre-card">
                        <div class="centre-header">
                            <div class="centre-icon">💎</div>
                            <div class="centre-info">
                                <h3>Profit</h3>
                                <span class="rate-info">KES 475 per trip</span>
                            </div>
                        </div>
                        <div class="centre-amount" id="profitTotal">KES 62,225</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // Global variables
        let currentDate = new Date(2025, 5, 28);
        let currentMonth = 5;
        let currentYear = 2025;
        let dailyData = {};
        let tripData = {};
        
        // Sample data for June 2025
        const sampleTripData = {
            '2025-06-02': 8, '2025-06-03': 6, '2025-06-04': 8, '2025-06-05': 9, '2025-06-06': 7,
            '2025-06-09': 8, '2025-06-10': 11, '2025-06-11': 5, '2025-06-12': 10, '2025-06-13': 8,
            '2025-06-16': 9, '2025-06-17': 10, '2025-06-18': 7, '2025-06-19': 8, '2025-06-20': 6,
            '2025-06-23': 10, '2025-06-24': 9, '2025-06-25': 8, '2025-06-26': 7, '2025-06-27': 8,
            '2025-06-30': 9
        };

        const sampleDailyData = {
            '2025-06-02': { trips: 8, fuelSpent: 10500, fuelLitres: 85.2, totalKilometers: 680, route: 'nairobi-mombasa', avgTripTime: 2.5 },
            '2025-06-03': { trips: 6, fuelSpent: 7800, fuelLitres: 63.4, totalKilometers: 510, route: 'nairobi-kisumu', avgTripTime: 3.0 },
            '2025-06-04': { trips: 8, fuelSpent: 10200, fuelLitres: 82.9, totalKilometers: 665, route: 'nairobi-mombasa', avgTripTime: 2.5 },
            '2025-06-05': { trips: 9, fuelSpent: 11700, fuelLitres: 95.1, totalKilometers: 765, route: 'nairobi-mombasa', avgTripTime: 2.3 },
            '2025-06-06': { trips: 7, fuelSpent: 9100, fuelLitres: 74.0, totalKilometers: 595, route: 'local-delivery', avgTripTime: 1.5 }
        };
        
        // Utility functions
        function formatNumber(num) {
            return new Intl.NumberFormat('en-KE').format(num);
        }
        
        function formatDate(date) {
            const options = { 
                weekday: 'long', 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric' 
            };
            return date.toLocaleDateString('en-US', options);
        }
        
        function getDateKey(date) {
            return date.toISOString().split('T')[0];
        }
        
        function isWeekend(date) {
            return date.getDay() === 0 || date.getDay() === 6;
        }
        
        function isToday(day, month, year) {
            const today = new Date();
            return day === today.getDate() && 
                   month === today.getMonth() && 
                   year === today.getFullYear();
        }
        
        function getDaysInMonth(month, year) {
            return new Date(year, month + 1, 0).getDate();
        }
        
        function getFirstDayOfMonth(month, year) {
            return new Date(year, month, 1).getDay();
        }

        function showNotification(message, type = 'success') {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'slideOutRight 0.3s ease-in';
                setTimeout(() => {
                    if (document.body.contains(notification)) {
                        document.body.removeChild(notification);
                    }
                }, 300);
            }, 3000);
        }
        
        // Tab Management
        function switchTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            document.querySelectorAll('.tab-button').forEach(btn => {
                btn.classList.remove('active');
            });
            
            document.getElementById(tabName + '-tab').classList.add('active');
            event.target.classList.add('active');
            
            if (tabName === 'monthly') {
                updateMonthlyCalendar();
            } else if (tabName === 'totals') {
                updateTotalsView();
            }
        }
        
        // Daily Management
        function updateDateDisplay() {
            const dateInput = document.getElementById('currentDate');
            const displayDate = document.getElementById('displayDate');
            const dayType = document.getElementById('dayType');
            const monthProgress = document.getElementById('monthProgress');
            
            dateInput.value = getDateKey(currentDate);
            displayDate.textContent = formatDate(currentDate);
            
            if (isWeekend(currentDate)) {
                dayType.textContent = currentDate.getDay() === 0 ? 'Sunday' : 'Saturday';
                dayType.style.color = '#e74c3c';
            } else {
                dayType.textContent = 'Working Day';
                dayType.style.color = '#27ae60';
            }
            
            const daysInMonth = new Date(currentDate.getFullYear(), currentDate.getMonth() + 1, 0).getDate();
            monthProgress.textContent = `Day ${currentDate.getDate()} of ${daysInMonth}`;
        }
        
        function loadDailyData() {
            const dateKey = getDateKey(currentDate);
            const data = dailyData[dateKey] || {};
            
            document.getElementById('dailyTrips').value = data.trips || '';
            document.getElementById('actualFuelSpent').value = data.fuelSpent || '';
            document.getElementById('fuelLitres').value = data.fuelLitres || '';
            document.getElementById('totalKilometers').value = data.totalKilometers || '';
            document.getElementById('routeSelect').value = data.route || '';
            document.getElementById('fuelStation').value = data.fuelStation || '';
            document.getElementById('vehicleCondition').value = data.vehicleCondition || 'good';
            document.getElementById('avgTripTime').value = data.avgTripTime || '';
        }
        
        function saveDailyData() {
            const dateKey = getDateKey(currentDate);
            const trips = parseInt(document.getElementById('dailyTrips').value) || 0;
            
            dailyData[dateKey] = {
                trips: trips,
                fuelSpent: parseFloat(document.getElementById('actualFuelSpent').value) || 0,
                fuelLitres: parseFloat(document.getElementById('fuelLitres').value) || 0,
                totalKilometers: parseFloat(document.getElementById('totalKilometers').value) || 0,
                route: document.getElementById('routeSelect').value,
                fuelStation: document.getElementById('fuelStation').value,
                vehicleCondition: document.getElementById('vehicleCondition').value,
                avgTripTime: parseFloat(document.getElementById('avgTripTime').value) || 0
            };
            
            tripData[dateKey] = trips;
        }
        
        function calculateDaily() {
            saveDailyData();
            
            const trips = parseInt(document.getElementById('dailyTrips').value) || 0;
            const fuelSpent = parseFloat(document.getElementById('actualFuelSpent').value) || 0;
            const fuelLitres = parseFloat(document.getElementById('fuelLitres').value) || 0;
            const totalKm = parseFloat(document.getElementById('totalKilometers').value) || 0;
            const avgTripTime = parseFloat(document.getElementById('avgTripTime').value) || 0;
            
            // Calculate revenue
            const dailyRevenue = trips * 3500;
            document.getElementById('dailyRevenue').textContent = 'KES ' + formatNumber(dailyRevenue);
            
            // Calculate time metrics
            const totalHours = trips * avgTripTime;
            document.getElementById('totalHours').textContent = totalHours.toFixed(1) + 'h';
            
            const revenuePerHour = totalHours > 0 ? dailyRevenue / totalHours : 0;
            document.getElementById('revenuePerHour').textContent = 'KES ' + formatNumber(Math.round(revenuePerHour));
            
            // Calculate fuel metrics
            const pricePerLitre = fuelLitres > 0 ? fuelSpent / fuelLitres : 0;
            document.getElementById('pricePerLitre').textContent = 'KES ' + formatNumber(Math.round(pricePerLitre));
            
            const budgetedFuel = trips * 1300;
            const fuelVariance = budgetedFuel - fuelSpent;
            document.getElementById('fuelVariance').textContent = 
                (fuelVariance >= 0 ? '+' : '') + 'KES ' + formatNumber(fuelVariance);
            document.getElementById('fuelVariance').style.color = fuelVariance >= 0 ? '#27ae60' : '#e74c3c';
            
            // Calculate distance metrics
            const kmPerTrip = trips > 0 ? totalKm / trips : 0;
            document.getElementById('kmPerTrip').textContent = kmPerTrip.toFixed(1);
            
            const kmPerLitre = fuelLitres > 0 ? totalKm / fuelLitres : 0;
            document.getElementById('kmPerLitre').textContent = kmPerLitre.toFixed(1);
        }
        
        function updateDaily() {
            const dateInput = document.getElementById('currentDate');
            currentDate = new Date(dateInput.value);
            updateDateDisplay();
            loadDailyData();
            calculateDaily();
        }
        
        function previousDay() {
            currentDate.setDate(currentDate.getDate() - 1);
            updateDateDisplay();
            loadDailyData();
            calculateDaily();
        }
        
        function nextDay() {
            currentDate.setDate(currentDate.getDate() + 1);
            updateDateDisplay();
            loadDailyData();
            calculateDaily();
        }
        
        function goToToday() {
            currentDate = new Date();
            updateDateDisplay();
            loadDailyData();
            calculateDaily();
        }

        function quickSave() {
            saveDailyData();
            showNotification('Daily data saved successfully!', 'success');
        }
        
        // Monthly Calendar Functions
        function updateMonthlyCalendar() {
            const monthSelect = document.getElementById('monthSelect');
            const yearSelect = document.getElementById('yearSelect');
            
            currentMonth = parseInt(monthSelect.value);
            currentYear = parseInt(yearSelect.value);
            
            generateMonthlyCalendar();
            calculateMonthlyStats();
        }
        
        function generateMonthlyCalendar() {
            const calendarGrid = document.getElementById('monthlyCalendarGrid');
            const daysInMonth = getDaysInMonth(currentMonth, currentYear);
            const firstDay = getFirstDayOfMonth(currentMonth, currentYear);
            
            calendarGrid.innerHTML = '';
            
            // Add day headers
            const dayHeaders = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
            dayHeaders.forEach(day => {
                const header = document.createElement('div');
                header.className = 'day-header';
                header.textContent = day;
                calendarGrid.appendChild(header);
            });
            
            // Add empty cells for days before month starts
            for (let i = 0; i < firstDay; i++) {
                const emptyCell = document.createElement('div');
                emptyCell.className = 'day-cell other-month';
                calendarGrid.appendChild(emptyCell);
            }
            
            // Add days of the month
            for (let day = 1; day <= daysInMonth; day++) {
                const dayCell = document.createElement('div');
                let cellClass = 'day-cell';
                
                if (isToday(day, currentMonth, currentYear)) {
                    cellClass += ' today';
                }
                if (isWeekend(new Date(currentYear, currentMonth, day))) {
                    cellClass += ' weekend';
                }
                
                const dateKey = `${currentYear}-${String(currentMonth + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
                const trips = tripData[dateKey] || 0;
                
                // Check if day has additional data
                if (dailyData[dateKey] && (dailyData[dateKey].fuelSpent || dailyData[dateKey].totalKilometers)) {
                    cellClass += ' has-data';
                }
                
                dayCell.className = cellClass;
                
                dayCell.innerHTML = `
                    <div class="day-number">${day}</div>
                    <input type="number" class="trip-input" min="0" value="${trips}" 
                           onchange="updateTrips('${dateKey}', this.value)" 
                           placeholder="Trips">
                    <div class="day-total">KES ${formatNumber(trips * 3500)}</div>
                `;
                
                calendarGrid.appendChild(dayCell);
            }
            
            // Fill remaining cells
            const totalCells = calendarGrid.children.length;
            const remainingCells = 42 - totalCells + 7;
            for (let i = 0; i < remainingCells; i++) {
                const emptyCell = document.createElement('div');
                emptyCell.className = 'day-cell other-month';
                calendarGrid.appendChild(emptyCell);
            }
        }
        
        function updateTrips(dateKey, value) {
            const trips = parseInt(value) || 0;
            tripData[dateKey] = trips;
            
            // Update the day total display
            const dayCell = event.target.parentElement;
            const dayTotal = dayCell.querySelector('.day-total');
            dayTotal.textContent = `KES ${formatNumber(trips * 3500)}`;
            
            // Update stored data
            if (!dailyData[dateKey]) dailyData[dateKey] = {};
            dailyData[dateKey].trips = trips;
            
            calculateMonthlyStats();
        }
        
        function calculateMonthlyStats() {
            const daysInMonth = getDaysInMonth(currentMonth, currentYear);
            let totalTrips = 0;
            let workingDays = 0;
            let monthlyRevenue = 0;
            let maxTrips = 0;
            let bestDay = '';
            let totalHours = 0;
            
            for (let day = 1; day <= daysInMonth; day++) {
                const dateKey = `${currentYear}-${String(currentMonth + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
                const trips = tripData[dateKey] || 0;
                const dayData = dailyData[dateKey] || {};
                
                if (trips > 0) {
                    workingDays++;
                    totalTrips += trips;
                    monthlyRevenue += trips * 3500;
                    
                    if (trips > maxTrips) {
                        maxTrips = trips;
                        bestDay = `${day}`;
                    }

                    if (dayData.avgTripTime > 0) {
                        totalHours += trips * dayData.avgTripTime;
                    }
                }
            }
            
            const avgPerDay = workingDays > 0 ? monthlyRevenue / workingDays : 0;
            
            document.getElementById('monthlyTotalTrips').textContent = totalTrips;
            document.getElementById('monthlyWorkingDays').textContent = workingDays;
            document.getElementById('monthlyRevenue').textContent = 'KES ' + formatNumber(monthlyRevenue);
            document.getElementById('monthlyAvgPerDay').textContent = 'KES ' + formatNumber(Math.round(avgPerDay));
            document.getElementById('monthlyBestDay').textContent = maxTrips > 0 ? `${maxTrips} trips (Day ${bestDay})` : '0 trips';
            document.getElementById('monthlyTotalHours').textContent = totalHours.toFixed(1) + 'h';
        }
        
        function fillWeekdays(trips) {
            const daysInMonth = getDaysInMonth(currentMonth, currentYear);
            let filledDays = 0;
            
            for (let day = 1; day <= daysInMonth; day++) {
                const date = new Date(currentYear, currentMonth, day);
                const dayOfWeek = date.getDay();
                
                if (dayOfWeek !== 0) { // Skip Sundays
                    const dateKey = `${currentYear}-${String(currentMonth + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
                    tripData[dateKey] = trips;
                    if (!dailyData[dateKey]) dailyData[dateKey] = {};
                    dailyData[dateKey].trips = trips;
                    filledDays++;
                }
            }
            
            generateMonthlyCalendar();
            calculateMonthlyStats();
            showNotification(`Filled ${filledDays} weekdays with ${trips} trips each`, 'success');
        }
        
        // Cost Centre Totals Functions
        function updateTotalsView() {
            calculateCostCentreTotals();
        }
        
        function calculateCostCentreTotals() {
            let totalTripsForPeriod = 0;
            const selectedMonth = parseInt(document.getElementById('totalsMonth').value);
            const selectedYear = parseInt(document.getElementById('totalsYear').value);
            
            // Count trips for the selected month/year
            Object.keys(tripData).forEach(dateKey => {
                const date = new Date(dateKey);
                if (date.getMonth() === selectedMonth && date.getFullYear() === selectedYear) {
                    totalTripsForPeriod += tripData[dateKey] || 0;
                }
            });
            
            // Cost structure per trip
            const costStructure = {
                fuelCost: 1300,
                fuelInterest: 195,
                driver: 250,
                mike: 200,
                captain: 100,
                boss: 100,
                truck: 478,
                capex: 502,
                profit: 475
            };
            
            // Calculate totals for each cost centre
            const totals = {};
            Object.keys(costStructure).forEach(centre => {
                totals[centre] = totalTripsForPeriod * costStructure[centre];
            });
            
            // Update display
            document.getElementById('totalTripsCount').textContent = totalTripsForPeriod;
            document.getElementById('totalRevenueAmount').textContent = 'KES ' + formatNumber(totalTripsForPeriod * 3500);
            
            // Update individual cost centre amounts
            document.getElementById('fuelCostTotal').textContent = 'KES ' + formatNumber(totals.fuelCost);
            document.getElementById('fuelInterestTotal').textContent = 'KES ' + formatNumber(totals.fuelInterest);
            document.getElementById('driverTotal').textContent = 'KES ' + formatNumber(totals.driver);
            document.getElementById('mikeTotalAmount').textContent = 'KES ' + formatNumber(totals.mike);
            document.getElementById('captainTotalAmount').textContent = 'KES ' + formatNumber(totals.captain);
            document.getElementById('bossTotalAmount').textContent = 'KES ' + formatNumber(totals.boss);
            document.getElementById('truckTotal').textContent = 'KES ' + formatNumber(totals.truck);
            document.getElementById('capexTotal').textContent = 'KES ' + formatNumber(totals.capex);
            document.getElementById('profitTotal').textContent = 'KES ' + formatNumber(totals.profit);
        }
        
        // Initialize the application
        function initializeApp() {
            // Load sample data
            tripData = { ...sampleTripData };
            dailyData = { ...sampleDailyData };
            
            // Initialize additional daily data for all trip days
            Object.keys(tripData).forEach(dateKey => {
                if (!dailyData[dateKey]) {
                    dailyData[dateKey] = { trips: tripData[dateKey] };
                }
            });
            
            updateDateDisplay();
            loadDailyData();
            calculateDaily();
            generateMonthlyCalendar();
            calculateMonthlyStats();
            updateTotalsView();
            
            showNotification('System loaded with sample data for June 2025!', 'success');
        }
        
        // Start when page loads
        window.addEventListener('DOMContentLoaded', initializeApp);
    </script>
</body>
</html>